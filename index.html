<!DOCTYPE html>
<html lang="sk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <title>Precvičovanie nemčiny</title>

  <!-- PWA META -->
  <meta name="theme-color" content="#4f46e5" />
  <link rel="manifest" href="/nemecky-jazyk/manifest.webmanifest" />
  <link rel="apple-touch-icon" href="/nemecky-jazyk/icon.png">

  <!-- Tailwind + fonty -->
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;800&display=swap" rel="stylesheet" />

  <style>
    body {
      font-family: 'Inter', sans-serif;
      background-color: #f1f5f9;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      margin: 0;
      padding: 1rem;
      box-sizing: border-box;
      user-select: auto;
    }
    .container {
      background-color: #f87171;
      border-radius: 1.5rem;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
      padding: 2rem;
      max-width: 680px;
      width: 100%;
      text-align: center;
      border: 4px solid #818cf8;
    }
    .button {
      padding: 0.75rem 1.25rem;
      font-weight: bold;
      border-radius: 9999px;
      color: white;
      transition: all 0.2s ease-in-out;
      cursor: pointer;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      text-align: center;
    }
    .button-indigo { background-color: #4f46e5; }
    .button-indigo:hover { background-color: #4338ca; transform: translateY(-2px); box-shadow: 0 6px 10px rgba(0,0,0,0.15); }
    .button-green { background-color: #22c55e; }
    .button-green:hover { background-color: #16a34a; transform: translateY(-2px); box-shadow: 0 6px 10px rgba(0,0,0,0.15); }
    .button-blue { background-color: #3b82f6; }
    .button-blue:hover { background-color: #2563eb; transform: translateY(-2px); box-shadow: 0 6px 10px rgba(0,0,0,0.15); }
    .button-red { background-color: #ef4444; }
    .button-red:hover { background-color: #dc2626; transform: translateY(-2px); box-shadow: 0 6px 10px rgba(0,0,0,0.15); }
    .button:disabled { background-color: #94a3b8; cursor: not-allowed; transform: none; box-shadow: none; }

    .word-display { min-height: 100px; display: flex; flex-direction: column; align-items: center; justify-content: center; }
    .slovak-display { min-height: 50px; margin-top: 1rem; display: flex; flex-direction: column; align-items: center; justify-content: center; }
    .speak-button {
      display: inline-flex; align-items: center; justify-content: center;
      padding: 0.5rem 1rem; font-weight: bold; border-radius: 9999px;
      color: white; transition: all 0.2s ease-in-out; cursor: pointer; margin-top: 0.5rem;
    }
    .speak-button:disabled { background-color: #cbd5e1; cursor: not-allowed; color: #64748b; }

    .credits-box { background-color: #d1fae5; border: 2px solid #34d399; border-radius: 0.5rem; padding: 1rem; margin-top: 2rem; text-align: center; }
    .credits-text { color: #7c3aed; font-weight: bold; }

    /* Auto panel */
    .panel { background:#fff; border:2px solid #818cf8; border-radius:1rem; padding:1rem; margin-bottom:1rem; }
    .row { display:flex; gap:.5rem; flex-wrap:wrap; align-items:center; justify-content:center; }
    .muted { opacity:.85 }
  </style>
</head>
<body>
  <div class="container">
    <h1 class="text-3xl font-bold text-slate-800 mb-6">Precvičovanie nemčiny</h1>

    <!-- AUTO REŽIM panel (iba tlačidlá) -->
    <div class="panel">
      <div class="row">
        <button id="auto-start"  class="button button-green">▶️ Spustiť auto</button>
        <button id="auto-pause"  class="button button-indigo" disabled>⏸️ Pauza</button>
        <button id="auto-resume" class="button button-indigo" disabled>▶️ Pokračovať</button>
        <button id="auto-stop"   class="button button-red"    disabled>⏹️ Stop</button>
        <button id="auto-prev"   class="button button-blue"   disabled>⏮️ Predošlé</button>
        <button id="auto-next"   class="button button-blue"   disabled>⏭️ Ďalšie</button>
      </div>
      <div id="auto-status" class="muted" style="margin-top:.5rem">Pripravené…</div>
    </div>

    <div id="app-content"></div>

    <div class="credits-box">
      <span class="credits-text">Vytvoril: Ivan Kebra Nagast</span>
    </div>
  </div>

  <script>
    // --- TTS helper (Safari/iPhone friendly) ---
    const TTS = (() => {
      const synth = window.speechSynthesis;

      function loadVoicesOnce() {
        return new Promise(resolve => {
          if (!('speechSynthesis' in window)) { resolve([]); return; }
          let voices = synth.getVoices();
          if (voices && voices.length) { resolve(voices); return; }

          const onChange = () => {
            voices = synth.getVoices();
            if (voices && voices.length) {
              synth.removeEventListener('voiceschanged', onChange);
              resolve(voices);
            }
          };
          synth.addEventListener('voiceschanged', onChange);

          const iv = setInterval(() => {
            voices = synth.getVoices();
            if (voices && voices.length) {
              clearInterval(iv);
              synth.removeEventListener('voiceschanged', onChange);
              resolve(voices);
            }
          }, 200);

          setTimeout(() => {
            clearInterval(iv);
            synth.removeEventListener('voiceschanged', onChange);
            resolve(synth.getVoices() || []);
          }, 3000);
        });
      }

      function pickVoiceByLang(lang, preferNames = []) {
        const list = (synth.getVoices() || []).filter(v => (v.lang || "").toLowerCase().startsWith(lang.toLowerCase()));
        if (!list.length) return null;
        for (const name of preferNames) {
          const hit = list.find(v => (v.name || "").toLowerCase().includes(name.toLowerCase()));
          if (hit) return hit;
        }
        return list[0];
      }

      async function speak(text, langCode, rate=1.0) {
        if (!('speechSynthesis' in window)) return;
        await loadVoicesOnce();

        const u = new SpeechSynthesisUtterance(String(text));
        u.lang = langCode;
        const prefer = langCode === "de-DE" ? ["Anna","Markus","Katja","Yannick"] : ["Laura","Zuzana","Filip","Ján"];
        const voice = pickVoiceByLang(langCode, prefer);
        if (voice) u.voice = voice;
        u.rate = rate; u.pitch = 1.0; u.volume = 1.0;

        return new Promise(res => {
          try {
            synth.cancel();
            u.onend = res;
            u.onerror = res;
            synth.speak(u);
          } catch(_) { res(); }
        });
      }

      function cancel(){ try { window.speechSynthesis.cancel(); } catch(_){} }

      return { speak, cancel };
    })();
    // --- KONIEC TTS ---

    document.addEventListener('DOMContentLoaded', () => {
      // ======= TVOJE DÁTA (ponechané) =======
      const vocabularyList = [
        { german: 'Vermutung', slovak: 'domienka, tušenie' },
        { german: 'Vermögen', slovak: 'majetok, schopnosť' },
        { german: 'äußerste', slovak: 'najkrajnejší, krajnosť' },
        { german: 'die Ankündigung', slovak: 'oznámenie, ohlásenie, oznam' },
        { german: 'Fahrgestell', slovak: 'podvozok' },
        { german: 'zu schätzen', slovak: 'oceniť' },
        { german: 'loszulassen', slovak: 'nechať ísť' },
        { german: 'zusammenkommen', slovak: 'dať sa dokopy' },
        { german: 'auseinander', slovak: 'od seba' },
        { german: 'ein bisschen auseinander stehen', slovak: 'stáť blízko od seba' },
        { german: 'sich auseinander entwickeln', slovak: 'odvíjať sa jeden od druhého' },
        { german: 'begegnen', slovak: 'stretnúť' },
        { german: 'begegnet', slovak: 'stretol' },
        { german: 'der/die Zweifel', slovak: 'neistota, pochybnosť' },
        { german: 'der Leichnam', slovak: 'mŕtvola' },
        { german: 'mitmachen', slovak: 'zúčastniť sa' },
        { german: 'Ja ich werde mache mit', slovak: 'Áno, pridám sa' },
        { german: 'Ja, ich schließe mich an', slovak: 'Áno, súhlasím s tým' },
        { german: 'Rinderfilet', slovak: 'hovädzia sviečkovica' },
        { german: 'Auftragsverfolgung', slovak: 'sledovanie objednávky' },
        { german: 'der Scherz', slovak: 'sranda, žart' },
        { german: 'die Zuversicht', slovak: 'nádej, dôvera, viera' },
        { german: 'Abschließen', slovak: 'zamknúť' },
        { german: 'Aufschließen', slovak: 'odomknúť' },
        { german: 'Ich möchte mich gerne nach der Miete erkundigen', slovak: 'Chcel by som sa opýtať na nájomné' },
        { german: 'der Bluterguss', slovak: 'modrina' },
        { german: 'die Narbe', slovak: 'jazva' },
        { german: 'der Ausschlag', slovak: 'vyrážka' },
        { german: 'die Schnittwunde', slovak: 'porezanie' },
        { german: 'der Splitter', slovak: 'trieska' },
        { german: 'Glühwürmchen', slovak: 'svetluška' },
        { german: 'Einrichtungshaus', slovak: 'obchod s nábytkom' },
        { german: 'bewirkt', slovak: 'spôsobí, spôsobia' },
        { german: 'Erwachen', slovak: 'prebudenie, zobudenie' },
        { german: 'Arbeitsunfähigkeitsbescheinigung', slovak: 'práceneschopnosť, PN-ka' },
        { german: 'Schuhe anziehen', slovak: 'obuť sa' },
        { german: 'Schuhe ausziehen', slovak: 'vyzuť sa' },
        { german: 'Sich anziehen', slovak: 'obliecť sa' },
        { german: 'Sich ausziehen', slovak: 'vyzliecť sa' },
        { german: 'Zieh deine Schuhe aus!', slovak: 'vyzuj sa!' },
        { german: 'Zieh deine Sachen aus!', slovak: 'vyzleč sa!' },
        { german: 'Zieh Dich aus!', slovak: 'vyzleč sa!' },
        { german: 'zieh dich aus baby', slovak: 'vyzleč sa, zlato' },
        { german: 'Zieh deine Kleidung aus, Baby', slovak: 'vyzleč sa, zlatko' },
        { german: 'Übergeben', slovak: 'odovzdať' },
        { german: 'Ich betrachte das als eine Lüge', slovak: 'Považujem to za lož' },
        { german: 'schäm dich so zu lügen!', slovak: 'Hanba ti takto klamať' },
        { german: 'God segne dich', slovak: 'Boh ti žehnaj' },
        { german: 'Kartoffel schälen und würfeln', slovak: 'Zemiaky ošúpeme a nakrájame na kocky' },
        { german: 'Nebelhorn', slovak: 'hmlovka' },
        { german: 'Schwein Haxe', slovak: 'prasacie koleno' },
        { german: 'So habe ich das nie gesagt! Du drehst mir immer das Wort im Munde herum!', slovak: 'Nikdy som to takto nepovedal, vždy prekrúcaš moje slová!' },
        { german: 'Luftabwehr', slovak: 'protivzdušná obrana' },
        { german: 'Gehirner schütterung', slovak: 'otras mozgu' },
        { german: 'Beinbruch', slovak: 'zlomená noha' },
        { german: 'Krankenhausaufenthalt', slovak: 'hospitalizácia' },
        { german: 'Ich bin im Reinen mit mir', slovak: 'Som so sebou vyrovnaný' },
        { german: 'Notaufnahme', slovak: 'pohotovostný príjem' },
        { german: 'Zinssatz', slovak: 'úroková sadzba' },
        { german: 'Jahrzente', slovak: 'desaťročia' },
        { german: 'LG/liebe grüße', slovak: 's láskou' },
        { german: 'Wer sollst du sein?', slovak: 'Kto si ty?' },
        { german: 'ich wünschte zwischen uns wäre was', slovak: 'Chcel by som, aby medzi nami niečo bolo' },
        { german: 'Vogelgezwitscher', slovak: 'vtáčí spev, vtáčie štebotanie' },
        { german: 'Verkehrssituation', slovak: 'dopravná situácia' },
        { german: 'Tränensäcke', slovak: 'vaky pod očami / opuchnuté viečka / kruhy pod očami / tmavé kruhy pod očami' },
        { german: 'Inwiefern stimmen Sie den folgenden Aussadem zu?', slovak: 'Do akej miery súhlasíte s nasledujúcimi tvrdeniami?' },
        { german: 'Bin unentschieden', slovak: 'Nie som rozhodnutý' },
        { german: 'Gelegentlich', slovak: 'príležitostne' },
        { german: 'Lass Dich nicht unterkriegen!', slovak: 'Nenechaj sa zlomiť! / Nepoddaj sa! / Bojuj ďalej! / Zostaň silný! / Nevzdávaj sa svojich snov!' },
        { german: 'das Magengeschwür', slovak: 'žalúdočný vred' },
        { german: 'Befreiung von der Zuzahlung', slovak: 'oslobodenie od poplatku za spoluúčasť' },
        { german: 'Das Leben ist wirklich hart, wir müssen ständig kämpfen, and wir bekommen das Wichtigste nicht, nämlich die Liebe.', slovak: 'Život je naozaj ťažký, stále musíme bojovať, a to najdôležitejšie, lásku, často nedostaneme.' },
        { german: 'Folsäure', slovak: 'kyselina listová' },
        { german: 'Abgehauen', slovak: 'ujsť, utiecť, zmiznúť' },
        { german: 'Meine Gesundheit macht mir im Moment zu schaffen', slovak: 'Moje zdravie mi momentálne dáva zabrať' },
        { german: 'Liegestütze', slovak: 'kliky' },
        { german: 'Engagiert sich für die Einhaltung der Menschenrechte entlang seiner Lieferkette', slovak: 'Zaviazali sa dodržiavať ľudské práva …' },
        { german: 'Im Folgenden geht es um das Thema Alltag', slovak: 'Nasledujúci text sa týka každodenného života' },
        { german: 'Vollzeit erwerbstätig', slovak: 'zamestnaný na plný úväzok' },
        { german: 'Beugen', slovak: 'ohnúť' },
        { german: 'Strecken', slovak: 'narovnať, roztiahnuť, natiahnuť' },
        { german: 'Spreiz deine Beine!', slovak: 'Roztiahni nohy!' },
        { german: 'Grätsche die Beine!', slovak: 'Roztiahni nohy doširoka!' },
        { german: 'Verwechsle vier Dinge nicht: Höflichkeit ist kein flirten …', slovak: 'Nezamieňajte si štyri veci: …' },
        { german: 'bevorzugen', slovak: 'uprednostňovať, preferovať' },
        { german: 'Widerlich', slovak: 'odporný, hnusný, nechutný' },
        { german: 'Abfindung', slovak: 'odstupné' },
        { german: 'Verkehrsunfall wegen Raser', slovak: 'dopravná nehoda pre rýchlu jazdu' },
        { german: 'Regierungschef', slovak: 'vedúci predstaviteľ vlády' },
        { german: 'Premierminister', slovak: 'predseda vlády' },
        { german: 'Krampfadern (Varizen)', slovak: 'kŕčové žily' },
        { german: 'Ich war gestern nicht gut drauf', slovak: 'Včera som nemal dobrú náladu' },
        { german: 'Ärztliche Bereitschaftspraxis', slovak: 'lekárska pohotovosť' },
        { german: 'Wertstoffhof', slovak: 'recyklačné centrum' },
        { german: 'Kiefer brechen', slovak: 'lámanie čeľuste' },
        { german: 'Widereingliederung', slovak: 'reintegrácia' },
        { german: 'Spine massager', slovak: 'masážny prístroj na chrbticu' },
        { german: 'Kommt mir bekannt vor', slovak: 'zdá sa mi to známe' },
        { german: 'Das Handgelenk lockert sich langsam', slovak: 'zápästie sa pomaly uvoľňuje' },
        { german: 'Gerichtsvollzieher', slovak: 'súdny exekútor' },
        { german: 'Ich gehe aus', slovak: 'vyrážam' },
        { german: 'rund um die Uhr', slovak: 'nonstop' },
        { german: 'Voraussichtliche Zustellung', slovak: 'odhadované dodanie' },
        { german: 'krankheitsbedingt', slovak: 'z dôvodu choroby' },
        { german: 'Lob sei Gott', slovak: 'chvála Bohu' },
        { german: 'Got sei dank', slovak: 'vďaka Bohu' },
        { german: 'Erzieherin', slovak: 'vychovávateľka' },
        { german: 'Je', slovak: 'čím' },
        { german: 'Desto', slovak: 'tým' },
        { german: 'Wurst', slovak: 'klobása, hurka, párky, špekačky' },
        { german: 'Blutwurst / Grützwurst', slovak: 'jaternica / hurka' },
        { german: 'Würstchen', slovak: 'párky' },
        { german: 'Speckwürstchen / Bratwürstchen', slovak: 'špekačky / klobása' },
        { german: 'Packetzusteller', slovak: 'kuriér' },
        { german: 'Ich möchte weder Fleisch noch Fisch', slovak: 'Nechcem ani mäso, ani rybu' },
        { german: 'Bei einer jungen Frau wird der Schwanz ruiniert …', slovak: '(vulg.)' },
        { german: 'Höschen', slovak: 'nohavičky' },
        { german: 'das Gleis', slovak: 'koľaj' },
        { german: 'Schiene', slovak: 'dlaha' },
        { german: 'Schienen', slovak: 'koľajnice' },
        { german: 'Strecke', slovak: 'trať, úsek, trasa' },
        { german: 'GmbH', slovak: 's.r.o.' },
        { german: 'Schämen', slovak: 'hanbiť sa' },
        { german: 'empfehlen', slovak: 'odporučiť' },
        { german: 'Wunder', slovak: 'zázrak' },
        { german: 'teilnehmen', slovak: 'zúčastniť sa' },
        { german: 'Meine Schulter fängt an zu vernarben', slovak: 'rameno sa začína zjazvovať' },
        { german: 'Die Stirn', slovak: 'čelo' },
        { german: 'Die Ferse', slovak: 'päta' },
        { german: 'Die Handfläche', slovak: 'dlaň' },
        { german: 'Der Fußrücken', slovak: 'priehlavok' },
        { german: 'Das Schienbein', slovak: 'holeň' },
        { german: 'Der Oberschenkel', slovak: 'stehno' },
        { german: 'Die Wimpern', slovak: 'mihalnice' },
        { german: 'Die Augenbraue', slovak: 'obočie' },
        { german: 'Aufzeichnen', slovak: 'nahrávať' },
        { german: 'die Witwe', slovak: 'vdova' },
        { german: 'Vorfahrt gewähren', slovak: 'dať prednosť' },
        { german: 'dauerhafte Folgen', slovak: 'trvalé následky' },
        { german: 'Erwerbsunfähigkeitsrente', slovak: 'invalidný dôchodok' },
        { german: 'Kann ich … beantragen?', slovak: 'Môžem požiadať …?' },
        { german: 'Zinsen', slovak: 'úroky' },
        { german: 'Finger und Handgelenk werden steifer', slovak: 'prsty a zápästie sú tuhšie' },
        { german: 'extrem ernste Bedrohung', slovak: 'mimoriadne závažná hrozba' },
        { german: 'gemobbt', slovak: 'šikanovaný' },
        { german: 'Gemütlichkeit', slovak: 'útulnosť' },
        { german: 'Wovon ist das abhängig?', slovak: 'Na čom to závisí?' },
        { german: 'Ärztlicher Bereitschaftsdienst', slovak: 'lekárska pohotovosť' },
        { german: 'Erleichterung', slovak: 'úľava' },
        { german: 'Zuversicht', slovak: 'dôvera' },
        { german: 'Besinnliche Weihnachtszeit', slovak: 'pokojné Vianoce' },
        { german: 'Verpiss dich', slovak: 'zmizni' },
        { german: 'Im Bett bist du eine Null!', slovak: 'v posteli si nula' },
        { german: 'Schnall dich an!', slovak: 'Zapni si pás!' },
        { german: 'Herausforderung', slovak: 'výzva' },
        { german: 'Ich musste mich entscheiden', slovak: 'musel som sa rozhodnúť' }
      ];

      const kpakContent = [
        { german: 'KPAK', slovak: 'KPAK' },
        { german: 'Wann?', slovak: 'Kedy?' },
        { german: 'Warum?', slovak: 'Prečo?' },
        { german: 'Wie?', slovak: 'Ako?' },
        { german: 'Wo?', slovak: 'Kde?' },
        { german: 'Ich gehe', slovak: 'Idem / Pôjdem' },
        { german: '➡️ morgen', slovak: '➡️ zajtra' },
        { german: '➡️ wegen meiner Arbeit', slovak: '➡️ kvôli mojej práci' },
        { german: '➡️ mit dem Fahrrad', slovak: '➡️ na bicykli' },
        { german: '➡️ in die Stadt', slovak: '➡️ do mesta' },
        { german: 'holen', slovak: 'priniesť, zájsť po' },
        { german: 'Ich hole mir ein Glas Wasser.', slovak: 'Idem si po pohár vody.' },
        { german: 'Kannst du die Zeitung holen?', slovak: 'Môžeš priniesť noviny.' },
        { german: 'abholen', slovak: 'vyzdvihnúť' },
        { german: 'Ich hole dich vom Bahnhof ab.', slovak: 'Vyzdvihnem ťa na stanici.' },
        { german: 'Er holt das Paket ab.', slovak: 'Ide si po balík.' },
        { german: 'sich erholen', slovak: 'zotaviť sa' },
        { german: 'Ich erhole mich am Wochenende.', slovak: 'Oddýchnem si cez víkend.' },
        { german: 'Sie hat sich gut erholt.', slovak: 'Dobre sa zotavila.' },
        { german: 'durchnässt', slovak: 'premočený' },
        { german: 'zählen auf', slovak: 'spoliehať sa na' },
        { german: 'Ich zähle auf dich.', slovak: 'Spolieham sa na teba.' },
        { german: 'zählen zu', slovak: 'patriť k' },
        { german: 'Er zählt zu den Besten.', slovak: 'Patrí medzi najlepších.' }
      ];
      // ======= /DÁTA =======

      const appContent = document.getElementById('app-content');
      let currentWordIndex = 0;
      let showSlovak = false;
      let currentChapter = 'main';
      let kpakIndex = 0;

      // Pôvodné ovládanie (ponechané)
      const speakText = async (text, langShort) => {
        const lang = (langShort === 'de') ? 'de-DE' : 'sk-SK';
        await TTS.speak(text, lang, 1.0);
      };

      const getNextWord = () => {
        showSlovak = false;
        if (currentChapter === 'main') {
          if (currentWordIndex >= vocabularyList.length) currentWordIndex = 0;
        } else {
          if (kpakIndex >= kpakContent.length) kpakIndex = 0;
        }
        render();
      };

      const handleReveal = () => { showSlovak = true; render(); };

      const handleNext = () => {
        if (currentChapter === 'main') currentWordIndex++;
        else kpakIndex++;
        getNextWord();
      };

      const switchToKpak = () => { currentChapter = 'kpak'; kpakIndex = 0; getNextWord(); };
      const switchToMain = () => { currentChapter = 'main'; currentWordIndex = 0; getNextWord(); };

      const render = () => {
        let currentContent;
        if (currentChapter === 'main') {
          if (currentWordIndex >= vocabularyList.length) {
            appContent.innerHTML = `
              <div class="word-display">
                <p class="text-3xl font-extrabold text-white">Gratulujem!</p>
                <p class="text-xl font-semibold text-white mt-4">Prešli ste všetky slová.</p>
                <button id="restartBtn" class="button button-indigo mt-8">Začať odznova</button>
                <button id="switch-to-kpak-btn" class="button button-green mt-4">Prejsť na kapitolu KPAK</button>
              </div>`;
            document.getElementById('restartBtn').addEventListener('click', () => { currentWordIndex = 0; getNextWord(); });
            document.getElementById('switch-to-kpak-btn').addEventListener('click', switchToKpak);
            return;
          }
          currentContent = vocabularyList[currentWordIndex];
        } else {
          if (kpakIndex >= kpakContent.length) {
            appContent.innerHTML = `
              <div class="word-display">
                <p class="text-3xl font-extrabold text-white">Koniec kapitoly KPAK!</p>
                <p class="text-xl font-semibold text-white mt-4">Prešli ste všetky slová z tejto sekcie.</p>
                <button id="back-to-main-btn" class="button button-indigo mt-8">Návrat k hlavnému zoznamu</button>
                <button id="restartKpakBtn" class="button button-green mt-4">Začať odznova kapitolu KPAK</button>
              </div>`;
            document.getElementById('back-to-main-btn').addEventListener('click', switchToMain);
            document.getElementById('restartKpakBtn').addEventListener('click', () => { kpakIndex = 0; getNextWord(); });
            return;
          }
          currentContent = kpakContent[kpakIndex];
        }

        let html = '';
        html += `<div class="word-display">`;
        html += `<p class="text-white text-4xl font-extrabold break-words max-w-full" style="user-select: text;">${currentContent.german}</p>`;
        html += `<button id="playGerman" class="speak-button button-blue">Prehrať v nemčine</button>`;
        html += `</div>`;

        if (showSlovak) {
          html += `<div class="slovak-display">
              <p class="text-white text-xl font-semibold break-words max-w-full" style="user-select: text;">${currentContent.slovak}</p>
              <button id="playSlovak" class="speak-button button-green">Prehrať v slovenčine</button>
            </div>`;
        }

        html += `<div class="flex flex-col space-y-3 mt-8">`;
        html += `<button id="revealBtn" class="button button-indigo">Zobraziť preklad</button>`;
        html += `<button id="nextBtn" class="button button-red">Ďalšie slovo</button>`;

        if (currentChapter === 'main') {
          html += `<button id="switch-to-kpak-btn" class="button button-green mt-4">Prejsť na kapitolu KPAK</button>`;
        } else {
          html += `<button id="back-to-main-btn" class="button button-green mt-4">Návrat k hlavnému zoznamu</button>`;
        }

        html += `</div>`;

        appContent.innerHTML = html;

        document.getElementById('playGerman').addEventListener('click', () => { speakText(currentContent.german, 'de'); });
        document.getElementById('nextBtn').addEventListener('click', handleNext);
        document.getElementById('revealBtn').addEventListener('click', handleReveal);

        if (showSlovak) {
          document.getElementById('playSlovak').addEventListener('click', () => { speakText(currentContent.slovak, 'sk'); });
        }

        if (currentChapter === 'main') {
          document.getElementById('switch-to-kpak-btn').addEventListener('click', switchToKpak);
        } else {
          document.getElementById('back-to-main-btn').addEventListener('click', switchToMain);
        }
      };

      getNextWord();

      // ---- AUTO REŽIM (DE → ukáž preklad → SK → ďalšie) ----
      const $ = (id) => document.getElementById(id);
      const elStart = $("auto-start");
      const elPause = $("auto-pause");
      const elResume= $("auto-resume");
      const elStop  = $("auto-stop");
      const elPrev  = $("auto-prev");
      const elNext  = $("auto-next");
      const elStatus= $("auto-status");

      // pevné hodnoty
      const AUTO_RATE  = 1.0;   // rýchlosť hlasu
      const AUTO_DELAY = 600;   // pauza DE → SK (ms)
      const AUTO_START_INDEX = 0;
      const AUTO_FINISH = "stop"; // "stop" alebo "loop"

      const st = {
        running:false, paused:false,
        get data(){ return currentChapter === 'main' ? vocabularyList : kpakContent; },
        get i(){ return currentChapter === 'main' ? currentWordIndex : kpakIndex; },
        set i(v){
          if (currentChapter === 'main') currentWordIndex = v;
          else kpakIndex = v;
        }
      };

      function setBtns(){
        elStart.disabled  = st.running;
        elPause.disabled  = !st.running || st.paused;
        elResume.disabled = !st.running || !st.paused;
        elStop.disabled   = !st.running;
        elPrev.disabled   = !st.running;
        elNext.disabled   = !st.running;
      }
      function status(t){ elStatus.textContent = t; }

      async function playOne(index){
        const list = st.data;
        if (!list[index]) return false;
        const item = list[index];

        status(`🔊 [${index+1}/${list.length}] DE: ${item.german}`);
        await TTS.speak(item.german, "de-DE", AUTO_RATE);
        if (!st.running) return false;

        showSlovak = true; render();

        await new Promise(r => setTimeout(r, AUTO_DELAY));
        if (!st.running) return false;

        status(`🔊 [${index+1}/${list.length}] SK: ${item.slovak}`);
        await TTS.speak(item.slovak, "sk-SK", AUTO_RATE);
        return true;
      }

      async function loop(){
        setBtns();
        while (st.running){
          if (st.paused){ await new Promise(r=>setTimeout(r,150)); continue; }
          const ok = await playOne(st.i);
          if (!ok || !st.running) break;

          st.i++;
          if (st.i >= st.data.length){
            if (AUTO_FINISH === 'loop'){ st.i = 0; }
            else { stopAuto(); break; }
          } else {
            showSlovak = false; render();
          }
        }
      }

      function startAuto(){
        if (!st.data.length){ status("Žiadne dáta."); return; }
        st.i = Math.max(0, Math.min(st.data.length-1, AUTO_START_INDEX));
        st.running = true; st.paused = false;
        status("Auto režim beží…");
        setBtns();
        loop();
      }
      function stopAuto(){
        st.running = false; st.paused = false;
        TTS.cancel();
        status("Zastavené.");
        setBtns();
      }
      function pauseAuto(){
        st.paused = true;
        try { window.speechSynthesis.pause(); } catch(_){}
        status("Pauza.");
        setBtns();
      }
      function resumeAuto(){
        st.paused = false;
        try { window.speechSynthesis.resume(); } catch(_){}
        status("Pokračujem…");
        setBtns();
      }
      function prevOne(){
        if (!st.running) return;
        st.i = Math.max(0, st.i - 1);
        TTS.cancel();
      }
      function nextOne(){
        if (!st.running) return;
        st.i = Math.min(st.data.length-1, st.i + 1);
        TTS.cancel();
      }

      elStart.addEventListener('click', startAuto);
      elStop .addEventListener('click', stopAuto);
      elPause.addEventListener('click', pauseAuto);
      elResume.addEventListener('click', resumeAuto);
      elPrev .addEventListener('click', prevOne);
      elNext .addEventListener('click', nextOne);
      // ---- KONIEC AUTO REŽIMU ----
    });

    // PWA: registrácia SW (GitHub Pages – správna cesta)
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('/nemecky-jazyk/sw.js').catch(console.error);
      });
    }
  </script>
</body>
</html>
