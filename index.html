<!DOCTYPE html>
<html lang="sk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <title>Precviƒçovanie nemƒçiny</title>

  <!-- PWA META -->
  <meta name="theme-color" content="#4f46e5" />
  <link rel="manifest" href="/nemecky-jazyk/manifest.webmanifest" />
  <link rel="apple-touch-icon" href="/nemecky-jazyk/icon.png">

  <!-- Tailwind + fonty -->
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;800&display=swap" rel="stylesheet" />

  <style>
    body {
      font-family: 'Inter', sans-serif;
      background-color: #f1f5f9;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      margin: 0;
      padding: 1rem;
      box-sizing: border-box;
      user-select: auto;
    }
    .container {
      background-color: #f87171;
      border-radius: 1.5rem;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
      padding: 2rem;
      max-width: 680px;
      width: 100%;
      text-align: center;
      border: 4px solid #818cf8;
    }
    .button {
      padding: 0.75rem 1.25rem;
      font-weight: bold;
      border-radius: 9999px;
      color: white;
      transition: all 0.2s ease-in-out;
      cursor: pointer;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      text-align: center;
    }
    .button-indigo { background-color: #4f46e5; }
    .button-indigo:hover { background-color: #4338ca; transform: translateY(-2px); box-shadow: 0 6px 10px rgba(0,0,0,0.15); }
    .button-green { background-color: #22c55e; }
    .button-green:hover { background-color: #16a34a; transform: translateY(-2px); box-shadow: 0 6px 10px rgba(0,0,0,0.15); }
    .button-blue { background-color: #3b82f6; }
    .button-blue:hover { background-color: #2563eb; transform: translateY(-2px); box-shadow: 0 6px 10px rgba(0,0,0,0.15); }
    .button-red { background-color: #ef4444; }
    .button-red:hover { background-color: #dc2626; transform: translateY(-2px); box-shadow: 0 6px 10px rgba(0,0,0,0.15); }
    .button:disabled { background-color: #94a3b8; cursor: not-allowed; transform: none; box-shadow: none; }

    .word-display { min-height: 100px; display: flex; flex-direction: column; align-items: center; justify-content: center; }
    .slovak-display { min-height: 50px; margin-top: 1rem; display: flex; flex-direction: column; align-items: center; justify-content: center; }
    .speak-button {
      display: inline-flex; align-items: center; justify-content: center;
      padding: 0.5rem 1rem; font-weight: bold; border-radius: 9999px;
      color: white; transition: all 0.2s ease-in-out; cursor: pointer; margin-top: 0.5rem;
    }
    .speak-button:disabled { background-color: #cbd5e1; cursor: not-allowed; color: #64748b; }

    .credits-box { background-color: #d1fae5; border: 2px solid #34d399; border-radius: 0.5rem; padding: 1rem; margin-top: 2rem; text-align: center; }
    .credits-text { color: #7c3aed; font-weight: bold; }

    /* Auto panel */
    .panel { background:#fff; border:2px solid #818cf8; border-radius:1rem; padding:1rem; margin-bottom:1rem; }
    .row { display:flex; gap:.5rem; flex-wrap:wrap; align-items:center; justify-content:center; }
    .muted { opacity:.85 }
  </style>
</head>
<body>
  <div class="container">
    <h1 class="text-3xl font-bold text-slate-800 mb-6">Precviƒçovanie nemƒçiny</h1>

    <!-- AUTO RE≈ΩIM panel (iba tlaƒçidl√°) -->
    <div class="panel">
      <div class="row">
        <button id="auto-start"  class="button button-green">‚ñ∂Ô∏è Spusti≈• auto</button>
        <button id="auto-pause"  class="button button-indigo" disabled>‚è∏Ô∏è Pauza</button>
        <button id="auto-resume" class="button button-indigo" disabled>‚ñ∂Ô∏è Pokraƒçova≈•</button>
        <button id="auto-stop"   class="button button-red"    disabled>‚èπÔ∏è Stop</button>
        <button id="auto-prev"   class="button button-blue"   disabled>‚èÆÔ∏è Predo≈°l√©</button>
        <button id="auto-next"   class="button button-blue"   disabled>‚è≠Ô∏è ƒéal≈°ie</button>
      </div>
      <div id="auto-status" class="muted" style="margin-top:.5rem">Pripraven√©‚Ä¶</div>
    </div>

    <div id="app-content"></div>

    <div class="credits-box">
      <span class="credits-text">Vytvoril: Ivan Kebra Nagast</span>
    </div>
  </div>

  <script>
    // --- TTS helper (Safari/iPhone friendly) ---
    const TTS = (() => {
      const synth = window.speechSynthesis;

      function loadVoicesOnce() {
        return new Promise(resolve => {
          if (!('speechSynthesis' in window)) { resolve([]); return; }
          let voices = synth.getVoices();
          if (voices && voices.length) { resolve(voices); return; }

          const onChange = () => {
            voices = synth.getVoices();
            if (voices && voices.length) {
              synth.removeEventListener('voiceschanged', onChange);
              resolve(voices);
            }
          };
          synth.addEventListener('voiceschanged', onChange);

          const iv = setInterval(() => {
            voices = synth.getVoices();
            if (voices && voices.length) {
              clearInterval(iv);
              synth.removeEventListener('voiceschanged', onChange);
              resolve(voices);
            }
          }, 200);

          setTimeout(() => {
            clearInterval(iv);
            synth.removeEventListener('voiceschanged', onChange);
            resolve(synth.getVoices() || []);
          }, 3000);
        });
      }

      function pickVoiceByLang(lang, preferNames = []) {
        const list = (synth.getVoices() || []).filter(v => (v.lang || "").toLowerCase().startsWith(lang.toLowerCase()));
        if (!list.length) return null;
        for (const name of preferNames) {
          const hit = list.find(v => (v.name || "").toLowerCase().includes(name.toLowerCase()));
          if (hit) return hit;
        }
        return list[0];
      }

      async function speak(text, langCode, rate=1.0) {
        if (!('speechSynthesis' in window)) return;
        await loadVoicesOnce();

        const u = new SpeechSynthesisUtterance(String(text));
        u.lang = langCode;
        const prefer = langCode === "de-DE" ? ["Anna","Markus","Katja","Yannick"] : ["Laura","Zuzana","Filip","J√°n"];
        const voice = pickVoiceByLang(langCode, prefer);
        if (voice) u.voice = voice;
        u.rate = rate; u.pitch = 1.0; u.volume = 1.0;

        return new Promise(res => {
          try {
            synth.cancel();
            u.onend = res;
            u.onerror = res;
            synth.speak(u);
          } catch(_) { res(); }
        });
      }

      function cancel(){ try { window.speechSynthesis.cancel(); } catch(_){} }

      return { speak, cancel };
    })();
    // --- KONIEC TTS ---

    document.addEventListener('DOMContentLoaded', () => {
      // ======= TVOJE D√ÅTA (ponechan√©) =======
      const vocabularyList = [
        { german: 'Vermutung', slovak: 'domienka, tu≈°enie' },
        { german: 'Verm√∂gen', slovak: 'majetok, schopnos≈•' },
        { german: '√§u√üerste', slovak: 'najkrajnej≈°√≠, krajnos≈•' },
        { german: 'die Ank√ºndigung', slovak: 'ozn√°menie, ohl√°senie, oznam' },
        { german: 'Fahrgestell', slovak: 'podvozok' },
        { german: 'zu sch√§tzen', slovak: 'oceni≈•' },
        { german: 'loszulassen', slovak: 'necha≈• √≠s≈•' },
        { german: 'zusammenkommen', slovak: 'da≈• sa dokopy' },
        { german: 'auseinander', slovak: 'od seba' },
        { german: 'ein bisschen auseinander stehen', slovak: 'st√°≈• bl√≠zko od seba' },
        { german: 'sich auseinander entwickeln', slovak: 'odv√≠ja≈• sa jeden od druh√©ho' },
        { german: 'begegnen', slovak: 'stretn√∫≈•' },
        { german: 'begegnet', slovak: 'stretol' },
        { german: 'der/die Zweifel', slovak: 'neistota, pochybnos≈•' },
        { german: 'der Leichnam', slovak: 'm≈ïtvola' },
        { german: 'mitmachen', slovak: 'z√∫ƒçastni≈• sa' },
        { german: 'Ja ich werde mache mit', slovak: '√Åno, prid√°m sa' },
        { german: 'Ja, ich schlie√üe mich an', slovak: '√Åno, s√∫hlas√≠m s t√Ωm' },
        { german: 'Rinderfilet', slovak: 'hov√§dzia svieƒçkovica' },
        { german: 'Auftragsverfolgung', slovak: 'sledovanie objedn√°vky' },
        { german: 'der Scherz', slovak: 'sranda, ≈æart' },
        { german: 'die Zuversicht', slovak: 'n√°dej, d√¥vera, viera' },
        { german: 'Abschlie√üen', slovak: 'zamkn√∫≈•' },
        { german: 'Aufschlie√üen', slovak: 'odomkn√∫≈•' },
        { german: 'Ich m√∂chte mich gerne nach der Miete erkundigen', slovak: 'Chcel by som sa op√Ωta≈• na n√°jomn√©' },
        { german: 'der Bluterguss', slovak: 'modrina' },
        { german: 'die Narbe', slovak: 'jazva' },
        { german: 'der Ausschlag', slovak: 'vyr√°≈æka' },
        { german: 'die Schnittwunde', slovak: 'porezanie' },
        { german: 'der Splitter', slovak: 'trieska' },
        { german: 'Gl√ºhw√ºrmchen', slovak: 'svetlu≈°ka' },
        { german: 'Einrichtungshaus', slovak: 'obchod s n√°bytkom' },
        { german: 'bewirkt', slovak: 'sp√¥sob√≠, sp√¥sobia' },
        { german: 'Erwachen', slovak: 'prebudenie, zobudenie' },
        { german: 'Arbeitsunf√§higkeitsbescheinigung', slovak: 'pr√°ceneschopnos≈•, PN-ka' },
        { german: 'Schuhe anziehen', slovak: 'obu≈• sa' },
        { german: 'Schuhe ausziehen', slovak: 'vyzu≈• sa' },
        { german: 'Sich anziehen', slovak: 'obliec≈• sa' },
        { german: 'Sich ausziehen', slovak: 'vyzliec≈• sa' },
        { german: 'Zieh deine Schuhe aus!', slovak: 'vyzuj sa!' },
        { german: 'Zieh deine Sachen aus!', slovak: 'vyzleƒç sa!' },
        { german: 'Zieh Dich aus!', slovak: 'vyzleƒç sa!' },
        { german: 'zieh dich aus baby', slovak: 'vyzleƒç sa, zlato' },
        { german: 'Zieh deine Kleidung aus, Baby', slovak: 'vyzleƒç sa, zlatko' },
        { german: '√úbergeben', slovak: 'odovzda≈•' },
        { german: 'Ich betrachte das als eine L√ºge', slovak: 'Pova≈æujem to za lo≈æ' },
        { german: 'sch√§m dich so zu l√ºgen!', slovak: 'Hanba ti takto klama≈•' },
        { german: 'God segne dich', slovak: 'Boh ti ≈æehnaj' },
        { german: 'Kartoffel sch√§len und w√ºrfeln', slovak: 'Zemiaky o≈°√∫peme a nakr√°jame na kocky' },
        { german: 'Nebelhorn', slovak: 'hmlovka' },
        { german: 'Schwein Haxe', slovak: 'prasacie koleno' },
        { german: 'So habe ich das nie gesagt! Du drehst mir immer das Wort im Munde herum!', slovak: 'Nikdy som to takto nepovedal, v≈ædy prekr√∫ca≈° moje slov√°!' },
        { german: 'Luftabwehr', slovak: 'protivzdu≈°n√° obrana' },
        { german: 'Gehirner sch√ºtterung', slovak: 'otras mozgu' },
        { german: 'Beinbruch', slovak: 'zlomen√° noha' },
        { german: 'Krankenhausaufenthalt', slovak: 'hospitaliz√°cia' },
        { german: 'Ich bin im Reinen mit mir', slovak: 'Som so sebou vyrovnan√Ω' },
        { german: 'Notaufnahme', slovak: 'pohotovostn√Ω pr√≠jem' },
        { german: 'Zinssatz', slovak: '√∫rokov√° sadzba' },
        { german: 'Jahrzente', slovak: 'desa≈•roƒçia' },
        { german: 'LG/liebe gr√º√üe', slovak: 's l√°skou' },
        { german: 'Wer sollst du sein?', slovak: 'Kto si ty?' },
        { german: 'ich w√ºnschte zwischen uns w√§re was', slovak: 'Chcel by som, aby medzi nami nieƒço bolo' },
        { german: 'Vogelgezwitscher', slovak: 'vt√°ƒç√≠ spev, vt√°ƒçie ≈°tebotanie' },
        { german: 'Verkehrssituation', slovak: 'dopravn√° situ√°cia' },
        { german: 'Tr√§nens√§cke', slovak: 'vaky pod oƒçami / opuchnut√© vieƒçka / kruhy pod oƒçami / tmav√© kruhy pod oƒçami' },
        { german: 'Inwiefern stimmen Sie den folgenden Aussadem zu?', slovak: 'Do akej miery s√∫hlas√≠te s nasleduj√∫cimi tvrdeniami?' },
        { german: 'Bin unentschieden', slovak: 'Nie som rozhodnut√Ω' },
        { german: 'Gelegentlich', slovak: 'pr√≠le≈æitostne' },
        { german: 'Lass Dich nicht unterkriegen!', slovak: 'Nenechaj sa zlomi≈•! / Nepoddaj sa! / Bojuj ƒèalej! / Zosta≈à siln√Ω! / Nevzd√°vaj sa svojich snov!' },
        { german: 'das Magengeschw√ºr', slovak: '≈æal√∫doƒçn√Ω vred' },
        { german: 'Befreiung von der Zuzahlung', slovak: 'oslobodenie od poplatku za spolu√∫ƒças≈•' },
        { german: 'Das Leben ist wirklich hart, wir m√ºssen st√§ndig k√§mpfen, and wir bekommen das Wichtigste nicht, n√§mlich die Liebe.', slovak: '≈Ωivot je naozaj ≈•a≈æk√Ω, st√°le mus√≠me bojova≈•, a to najd√¥le≈æitej≈°ie, l√°sku, ƒçasto nedostaneme.' },
        { german: 'Fols√§ure', slovak: 'kyselina listov√°' },
        { german: 'Abgehauen', slovak: 'ujs≈•, utiec≈•, zmizn√∫≈•' },
        { german: 'Meine Gesundheit macht mir im Moment zu schaffen', slovak: 'Moje zdravie mi moment√°lne d√°va zabra≈•' },
        { german: 'Liegest√ºtze', slovak: 'kliky' },
        { german: 'Engagiert sich f√ºr die Einhaltung der Menschenrechte entlang seiner Lieferkette', slovak: 'Zaviazali sa dodr≈æiava≈• ƒæudsk√© pr√°va ‚Ä¶' },
        { german: 'Im Folgenden geht es um das Thema Alltag', slovak: 'Nasleduj√∫ci text sa t√Ωka ka≈ædodenn√©ho ≈æivota' },
        { german: 'Vollzeit erwerbst√§tig', slovak: 'zamestnan√Ω na pln√Ω √∫v√§zok' },
        { german: 'Beugen', slovak: 'ohn√∫≈•' },
        { german: 'Strecken', slovak: 'narovna≈•, roztiahnu≈•, natiahnu≈•' },
        { german: 'Spreiz deine Beine!', slovak: 'Roztiahni nohy!' },
        { german: 'Gr√§tsche die Beine!', slovak: 'Roztiahni nohy do≈°iroka!' },
        { german: 'Verwechsle vier Dinge nicht: H√∂flichkeit ist kein flirten ‚Ä¶', slovak: 'Nezamie≈àajte si ≈°tyri veci: ‚Ä¶' },
        { german: 'bevorzugen', slovak: 'uprednost≈àova≈•, preferova≈•' },
        { german: 'Widerlich', slovak: 'odporn√Ω, hnusn√Ω, nechutn√Ω' },
        { german: 'Abfindung', slovak: 'odstupn√©' },
        { german: 'Verkehrsunfall wegen Raser', slovak: 'dopravn√° nehoda pre r√Ωchlu jazdu' },
        { german: 'Regierungschef', slovak: 'ved√∫ci predstaviteƒæ vl√°dy' },
        { german: 'Premierminister', slovak: 'predseda vl√°dy' },
        { german: 'Krampfadern (Varizen)', slovak: 'k≈ïƒçov√© ≈æily' },
        { german: 'Ich war gestern nicht gut drauf', slovak: 'Vƒçera som nemal dobr√∫ n√°ladu' },
        { german: '√Ñrztliche Bereitschaftspraxis', slovak: 'lek√°rska pohotovos≈•' },
        { german: 'Wertstoffhof', slovak: 'recyklaƒçn√© centrum' },
        { german: 'Kiefer brechen', slovak: 'l√°manie ƒçeƒæuste' },
        { german: 'Widereingliederung', slovak: 'reintegr√°cia' },
        { german: 'Spine massager', slovak: 'mas√°≈æny pr√≠stroj na chrbticu' },
        { german: 'Kommt mir bekannt vor', slovak: 'zd√° sa mi to zn√°me' },
        { german: 'Das Handgelenk lockert sich langsam', slovak: 'z√°p√§stie sa pomaly uvoƒæ≈àuje' },
        { german: 'Gerichtsvollzieher', slovak: 's√∫dny exek√∫tor' },
        { german: 'Ich gehe aus', slovak: 'vyr√°≈æam' },
        { german: 'rund um die Uhr', slovak: 'nonstop' },
        { german: 'Voraussichtliche Zustellung', slovak: 'odhadovan√© dodanie' },
        { german: 'krankheitsbedingt', slovak: 'z d√¥vodu choroby' },
        { german: 'Lob sei Gott', slovak: 'chv√°la Bohu' },
        { german: 'Got sei dank', slovak: 'vƒèaka Bohu' },
        { german: 'Erzieherin', slovak: 'vychov√°vateƒæka' },
        { german: 'Je', slovak: 'ƒç√≠m' },
        { german: 'Desto', slovak: 't√Ωm' },
        { german: 'Wurst', slovak: 'klob√°sa, hurka, p√°rky, ≈°pekaƒçky' },
        { german: 'Blutwurst / Gr√ºtzwurst', slovak: 'jaternica / hurka' },
        { german: 'W√ºrstchen', slovak: 'p√°rky' },
        { german: 'Speckw√ºrstchen / Bratw√ºrstchen', slovak: '≈°pekaƒçky / klob√°sa' },
        { german: 'Packetzusteller', slovak: 'kuri√©r' },
        { german: 'Ich m√∂chte weder Fleisch noch Fisch', slovak: 'Nechcem ani m√§so, ani rybu' },
        { german: 'Bei einer jungen Frau wird der Schwanz ruiniert ‚Ä¶', slovak: '(vulg.)' },
        { german: 'H√∂schen', slovak: 'nohaviƒçky' },
        { german: 'das Gleis', slovak: 'koƒæaj' },
        { german: 'Schiene', slovak: 'dlaha' },
        { german: 'Schienen', slovak: 'koƒæajnice' },
        { german: 'Strecke', slovak: 'tra≈•, √∫sek, trasa' },
        { german: 'GmbH', slovak: 's.r.o.' },
        { german: 'Sch√§men', slovak: 'hanbi≈• sa' },
        { german: 'empfehlen', slovak: 'odporuƒçi≈•' },
        { german: 'Wunder', slovak: 'z√°zrak' },
        { german: 'teilnehmen', slovak: 'z√∫ƒçastni≈• sa' },
        { german: 'Meine Schulter f√§ngt an zu vernarben', slovak: 'rameno sa zaƒç√≠na zjazvova≈•' },
        { german: 'Die Stirn', slovak: 'ƒçelo' },
        { german: 'Die Ferse', slovak: 'p√§ta' },
        { german: 'Die Handfl√§che', slovak: 'dla≈à' },
        { german: 'Der Fu√ür√ºcken', slovak: 'priehlavok' },
        { german: 'Das Schienbein', slovak: 'hole≈à' },
        { german: 'Der Oberschenkel', slovak: 'stehno' },
        { german: 'Die Wimpern', slovak: 'mihalnice' },
        { german: 'Die Augenbraue', slovak: 'oboƒçie' },
        { german: 'Aufzeichnen', slovak: 'nahr√°va≈•' },
        { german: 'die Witwe', slovak: 'vdova' },
        { german: 'Vorfahrt gew√§hren', slovak: 'da≈• prednos≈•' },
        { german: 'dauerhafte Folgen', slovak: 'trval√© n√°sledky' },
        { german: 'Erwerbsunf√§higkeitsrente', slovak: 'invalidn√Ω d√¥chodok' },
        { german: 'Kann ich ‚Ä¶ beantragen?', slovak: 'M√¥≈æem po≈æiada≈• ‚Ä¶?' },
        { german: 'Zinsen', slovak: '√∫roky' },
        { german: 'Finger und Handgelenk werden steifer', slovak: 'prsty a z√°p√§stie s√∫ tuh≈°ie' },
        { german: 'extrem ernste Bedrohung', slovak: 'mimoriadne z√°va≈æn√° hrozba' },
        { german: 'gemobbt', slovak: '≈°ikanovan√Ω' },
        { german: 'Gem√ºtlichkeit', slovak: '√∫tulnos≈•' },
        { german: 'Wovon ist das abh√§ngig?', slovak: 'Na ƒçom to z√°vis√≠?' },
        { german: '√Ñrztlicher Bereitschaftsdienst', slovak: 'lek√°rska pohotovos≈•' },
        { german: 'Erleichterung', slovak: '√∫ƒæava' },
        { german: 'Zuversicht', slovak: 'd√¥vera' },
        { german: 'Besinnliche Weihnachtszeit', slovak: 'pokojn√© Vianoce' },
        { german: 'Verpiss dich', slovak: 'zmizni' },
        { german: 'Im Bett bist du eine Null!', slovak: 'v posteli si nula' },
        { german: 'Schnall dich an!', slovak: 'Zapni si p√°s!' },
        { german: 'Herausforderung', slovak: 'v√Ωzva' },
        { german: 'Ich musste mich entscheiden', slovak: 'musel som sa rozhodn√∫≈•' }
      ];

      const kpakContent = [
        { german: 'KPAK', slovak: 'KPAK' },
        { german: 'Wann?', slovak: 'Kedy?' },
        { german: 'Warum?', slovak: 'Preƒço?' },
        { german: 'Wie?', slovak: 'Ako?' },
        { german: 'Wo?', slovak: 'Kde?' },
        { german: 'Ich gehe', slovak: 'Idem / P√¥jdem' },
        { german: '‚û°Ô∏è morgen', slovak: '‚û°Ô∏è zajtra' },
        { german: '‚û°Ô∏è wegen meiner Arbeit', slovak: '‚û°Ô∏è kv√¥li mojej pr√°ci' },
        { german: '‚û°Ô∏è mit dem Fahrrad', slovak: '‚û°Ô∏è na bicykli' },
        { german: '‚û°Ô∏è in die Stadt', slovak: '‚û°Ô∏è do mesta' },
        { german: 'holen', slovak: 'prinies≈•, z√°js≈• po' },
        { german: 'Ich hole mir ein Glas Wasser.', slovak: 'Idem si po poh√°r vody.' },
        { german: 'Kannst du die Zeitung holen?', slovak: 'M√¥≈æe≈° prinies≈• noviny.' },
        { german: 'abholen', slovak: 'vyzdvihn√∫≈•' },
        { german: 'Ich hole dich vom Bahnhof ab.', slovak: 'Vyzdvihnem ≈•a na stanici.' },
        { german: 'Er holt das Paket ab.', slovak: 'Ide si po bal√≠k.' },
        { german: 'sich erholen', slovak: 'zotavi≈• sa' },
        { german: 'Ich erhole mich am Wochenende.', slovak: 'Odd√Ωchnem si cez v√≠kend.' },
        { german: 'Sie hat sich gut erholt.', slovak: 'Dobre sa zotavila.' },
        { german: 'durchn√§sst', slovak: 'premoƒçen√Ω' },
        { german: 'z√§hlen auf', slovak: 'spolieha≈• sa na' },
        { german: 'Ich z√§hle auf dich.', slovak: 'Spolieham sa na teba.' },
        { german: 'z√§hlen zu', slovak: 'patri≈• k' },
        { german: 'Er z√§hlt zu den Besten.', slovak: 'Patr√≠ medzi najlep≈°√≠ch.' }
      ];
      // ======= /D√ÅTA =======

      const appContent = document.getElementById('app-content');
      let currentWordIndex = 0;
      let showSlovak = false;
      let currentChapter = 'main';
      let kpakIndex = 0;

      // P√¥vodn√© ovl√°danie (ponechan√©)
      const speakText = async (text, langShort) => {
        const lang = (langShort === 'de') ? 'de-DE' : 'sk-SK';
        await TTS.speak(text, lang, 1.0);
      };

      const getNextWord = () => {
        showSlovak = false;
        if (currentChapter === 'main') {
          if (currentWordIndex >= vocabularyList.length) currentWordIndex = 0;
        } else {
          if (kpakIndex >= kpakContent.length) kpakIndex = 0;
        }
        render();
      };

      const handleReveal = () => { showSlovak = true; render(); };

      const handleNext = () => {
        if (currentChapter === 'main') currentWordIndex++;
        else kpakIndex++;
        getNextWord();
      };

      const switchToKpak = () => { currentChapter = 'kpak'; kpakIndex = 0; getNextWord(); };
      const switchToMain = () => { currentChapter = 'main'; currentWordIndex = 0; getNextWord(); };

      const render = () => {
        let currentContent;
        if (currentChapter === 'main') {
          if (currentWordIndex >= vocabularyList.length) {
            appContent.innerHTML = `
              <div class="word-display">
                <p class="text-3xl font-extrabold text-white">Gratulujem!</p>
                <p class="text-xl font-semibold text-white mt-4">Pre≈°li ste v≈°etky slov√°.</p>
                <button id="restartBtn" class="button button-indigo mt-8">Zaƒça≈• odznova</button>
                <button id="switch-to-kpak-btn" class="button button-green mt-4">Prejs≈• na kapitolu KPAK</button>
              </div>`;
            document.getElementById('restartBtn').addEventListener('click', () => { currentWordIndex = 0; getNextWord(); });
            document.getElementById('switch-to-kpak-btn').addEventListener('click', switchToKpak);
            return;
          }
          currentContent = vocabularyList[currentWordIndex];
        } else {
          if (kpakIndex >= kpakContent.length) {
            appContent.innerHTML = `
              <div class="word-display">
                <p class="text-3xl font-extrabold text-white">Koniec kapitoly KPAK!</p>
                <p class="text-xl font-semibold text-white mt-4">Pre≈°li ste v≈°etky slov√° z tejto sekcie.</p>
                <button id="back-to-main-btn" class="button button-indigo mt-8">N√°vrat k hlavn√©mu zoznamu</button>
                <button id="restartKpakBtn" class="button button-green mt-4">Zaƒça≈• odznova kapitolu KPAK</button>
              </div>`;
            document.getElementById('back-to-main-btn').addEventListener('click', switchToMain);
            document.getElementById('restartKpakBtn').addEventListener('click', () => { kpakIndex = 0; getNextWord(); });
            return;
          }
          currentContent = kpakContent[kpakIndex];
        }

        let html = '';
        html += `<div class="word-display">`;
        html += `<p class="text-white text-4xl font-extrabold break-words max-w-full" style="user-select: text;">${currentContent.german}</p>`;
        html += `<button id="playGerman" class="speak-button button-blue">Prehra≈• v nemƒçine</button>`;
        html += `</div>`;

        if (showSlovak) {
          html += `<div class="slovak-display">
              <p class="text-white text-xl font-semibold break-words max-w-full" style="user-select: text;">${currentContent.slovak}</p>
              <button id="playSlovak" class="speak-button button-green">Prehra≈• v slovenƒçine</button>
            </div>`;
        }

        html += `<div class="flex flex-col space-y-3 mt-8">`;
        html += `<button id="revealBtn" class="button button-indigo">Zobrazi≈• preklad</button>`;
        html += `<button id="nextBtn" class="button button-red">ƒéal≈°ie slovo</button>`;

        if (currentChapter === 'main') {
          html += `<button id="switch-to-kpak-btn" class="button button-green mt-4">Prejs≈• na kapitolu KPAK</button>`;
        } else {
          html += `<button id="back-to-main-btn" class="button button-green mt-4">N√°vrat k hlavn√©mu zoznamu</button>`;
        }

        html += `</div>`;

        appContent.innerHTML = html;

        document.getElementById('playGerman').addEventListener('click', () => { speakText(currentContent.german, 'de'); });
        document.getElementById('nextBtn').addEventListener('click', handleNext);
        document.getElementById('revealBtn').addEventListener('click', handleReveal);

        if (showSlovak) {
          document.getElementById('playSlovak').addEventListener('click', () => { speakText(currentContent.slovak, 'sk'); });
        }

        if (currentChapter === 'main') {
          document.getElementById('switch-to-kpak-btn').addEventListener('click', switchToKpak);
        } else {
          document.getElementById('back-to-main-btn').addEventListener('click', switchToMain);
        }
      };

      getNextWord();

      // ---- AUTO RE≈ΩIM (DE ‚Üí uk√°≈æ preklad ‚Üí SK ‚Üí ƒèal≈°ie) ----
      const $ = (id) => document.getElementById(id);
      const elStart = $("auto-start");
      const elPause = $("auto-pause");
      const elResume= $("auto-resume");
      const elStop  = $("auto-stop");
      const elPrev  = $("auto-prev");
      const elNext  = $("auto-next");
      const elStatus= $("auto-status");

      // pevn√© hodnoty
      const AUTO_RATE  = 1.0;   // r√Ωchlos≈• hlasu
      const AUTO_DELAY = 600;   // pauza DE ‚Üí SK (ms)
      const AUTO_START_INDEX = 0;
      const AUTO_FINISH = "stop"; // "stop" alebo "loop"

      const st = {
        running:false, paused:false,
        get data(){ return currentChapter === 'main' ? vocabularyList : kpakContent; },
        get i(){ return currentChapter === 'main' ? currentWordIndex : kpakIndex; },
        set i(v){
          if (currentChapter === 'main') currentWordIndex = v;
          else kpakIndex = v;
        }
      };

      function setBtns(){
        elStart.disabled  = st.running;
        elPause.disabled  = !st.running || st.paused;
        elResume.disabled = !st.running || !st.paused;
        elStop.disabled   = !st.running;
        elPrev.disabled   = !st.running;
        elNext.disabled   = !st.running;
      }
      function status(t){ elStatus.textContent = t; }

      async function playOne(index){
        const list = st.data;
        if (!list[index]) return false;
        const item = list[index];

        status(`üîä [${index+1}/${list.length}] DE: ${item.german}`);
        await TTS.speak(item.german, "de-DE", AUTO_RATE);
        if (!st.running) return false;

        showSlovak = true; render();

        await new Promise(r => setTimeout(r, AUTO_DELAY));
        if (!st.running) return false;

        status(`üîä [${index+1}/${list.length}] SK: ${item.slovak}`);
        await TTS.speak(item.slovak, "sk-SK", AUTO_RATE);
        return true;
      }

      async function loop(){
        setBtns();
        while (st.running){
          if (st.paused){ await new Promise(r=>setTimeout(r,150)); continue; }
          const ok = await playOne(st.i);
          if (!ok || !st.running) break;

          st.i++;
          if (st.i >= st.data.length){
            if (AUTO_FINISH === 'loop'){ st.i = 0; }
            else { stopAuto(); break; }
          } else {
            showSlovak = false; render();
          }
        }
      }

      function startAuto(){
        if (!st.data.length){ status("≈Ωiadne d√°ta."); return; }
        st.i = Math.max(0, Math.min(st.data.length-1, AUTO_START_INDEX));
        st.running = true; st.paused = false;
        status("Auto re≈æim be≈æ√≠‚Ä¶");
        setBtns();
        loop();
      }
      function stopAuto(){
        st.running = false; st.paused = false;
        TTS.cancel();
        status("Zastaven√©.");
        setBtns();
      }
      function pauseAuto(){
        st.paused = true;
        try { window.speechSynthesis.pause(); } catch(_){}
        status("Pauza.");
        setBtns();
      }
      function resumeAuto(){
        st.paused = false;
        try { window.speechSynthesis.resume(); } catch(_){}
        status("Pokraƒçujem‚Ä¶");
        setBtns();
      }
      function prevOne(){
        if (!st.running) return;
        st.i = Math.max(0, st.i - 1);
        TTS.cancel();
      }
      function nextOne(){
        if (!st.running) return;
        st.i = Math.min(st.data.length-1, st.i + 1);
        TTS.cancel();
      }

      elStart.addEventListener('click', startAuto);
      elStop .addEventListener('click', stopAuto);
      elPause.addEventListener('click', pauseAuto);
      elResume.addEventListener('click', resumeAuto);
      elPrev .addEventListener('click', prevOne);
      elNext .addEventListener('click', nextOne);
      // ---- KONIEC AUTO RE≈ΩIMU ----
    });

    // PWA: registr√°cia SW (GitHub Pages ‚Äì spr√°vna cesta)
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('/nemecky-jazyk/sw.js').catch(console.error);
      });
    }
  </script>
</body>
</html>
